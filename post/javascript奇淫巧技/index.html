<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta name=generator content="Hugo 0.119.0"><title>JavaScript奇淫巧技 &#183; DefNed Blog</title><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css><!--[if lte IE 8]><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-old-ie-min.css><![endif]--><!--[if gt IE 8]><!--><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css><!--<![endif]--><!--[if lte IE 8]><link rel=stylesheet href=https://blog.dfned.com/css/side-menu-old-ie.css><![endif]--><!--[if gt IE 8]><!--><link rel=stylesheet href=https://blog.dfned.com/css/side-menu.css><!--<![endif]--><link rel=stylesheet href=https://blog.dfned.com/css/blackburn.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css><link rel=preconnect href=https://fonts.gstatic.com><link href="https://fonts.googleapis.com/css2?family=Raleway&display=swap" rel=stylesheet type=text/css><script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<link rel=stylesheet href=//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/styles/androidstudio.min.css><script async src=//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/highlight.min.js></script>
<script async src=//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/languages/yaml.min.js></script>
<script>hljs.initHighlightingOnLoad()</script><link rel="shortcut icon" href=https://blog.dfned.com/img/favicon.ico type=image/x-icon></head><body><div id=layout><a href=#menu id=menuLink class=menu-link><span></span></a><div id=menu><a class="pure-menu-heading brand" href=https://blog.dfned.com/>DefNed</a><div class=pure-menu><ul class=pure-menu-list><li class=pure-menu-item><a class=pure-menu-link href=https://blog.dfned.com/><i class='fa fa-home fa-fw'></i>Home</a></li><li class=pure-menu-item><a class=pure-menu-link href=https://blog.dfned.com/post/><i class='fa fa-list fa-fw'></i>Posts</a></li><li class=pure-menu-item><a class=pure-menu-link href=https://blog.dfned.com/topics/><i class='fa fa-folder fa-fw'></i>Topics</a></li><li class=pure-menu-item><a class=pure-menu-link href=https://blog.dfned.com/tags/><i class='fa fa-tags fa-fw'></i>Tags</a></li><li class=pure-menu-item><a class=pure-menu-link href=https://blog.dfned.com/about/><i class='fa fa-user fa-fw'></i>About</a></li><li class=pure-menu-item><a class=pure-menu-link href=https://blog.dfned.com/contact/><i class='fa fa-phone-square fa-fw'></i>Contact</a></li></ul></div><div class="pure-menu social"><ul class=pure-menu-list><li class=pure-menu-item><a class=pure-menu-link href=http://weibo.com/u/2061371847 rel=me target=_blank><i class="fab fa-weibo fa-fw"></i>Weibo</a></li><li class=pure-menu-item><a class=pure-menu-link href=https://github.com/Fengxq2014 rel=me target=_blank><i class="fab fa-github-square fa-fw"></i>GitHub</a></li></ul></div><div><div class=small-print><small>&copy; 2016. All rights reserved.</small></div><div class=small-print><small>Built with&nbsp;<a href=https://gohugo.io/ target=_blank>Hugo</a></small>
<small>Theme&nbsp;<a href=https://github.com/yoshiharuyamashita/blackburn target=_blank>Blackburn</a></small></div></div></div><div id=main><div class=header><h1>JavaScript奇淫巧技</h1><h2></h2></div><div class=content><div class=post-meta><div><i class="fa fa-calendar fa-fw"></i>
<time>10 Aug 2016, 14:14</time></div><div><i class="fa fa-folder fa-fw"></i>
<a class=post-taxonomy-topic href=https://blog.dfned.com/topics/%E6%9D%82%E9%A1%B9>杂项</a></div><div><i class="fa fa-tags fa-fw"></i>
<a class=post-taxonomy-tag href=https://blog.dfned.com/tags/javascript>JavaScript</a></div></div><p>本文整理自网络，所有代码都经过V8 5.2.361.49测试，不定时更新</p><h2 id=首次为变量赋值时务必使用var关键字>首次为变量赋值时务必使用var关键字</h2><p>变量没有声明而直接赋值得话，默认会作为一个新的全局变量，要尽量避免使用全局变量。</p><h2 id=使用-代替->使用<code>===</code> 代替<code> ==</code></h2><p><code>==</code>和<code>!=</code>操作符会在需要的情况下自动转换数据类型。但<code>===</code>和<code>!==</code>不会，它们会同时比较值和数据类型，这也使得它们要比<code>==</code>和<code>!=</code>快。</p><h2 id=undefinednull0falsenan空字符串的逻辑结果均为false><code>undefined</code>、<code>null</code>、<code>0</code>、<code>false</code>、<code>NaN</code>、<code>空字符串</code>的逻辑结果均为false</h2><h2 id=typeofinstanceof和contructor><code>typeof</code>、<code>instanceof</code>和<code>contructor</code></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>arr</span> <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#34;a&#34;</span>, <span style=color:#e6db74>&#34;b&#34;</span>, <span style=color:#e6db74>&#34;c&#34;</span>];
</span></span><span style=display:flex><span><span style=color:#66d9ef>typeof</span> <span style=color:#a6e22e>arr</span>;   <span style=color:#75715e>// 返回 &#34;object&#34; 
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>arr</span> <span style=color:#66d9ef>instanceof</span> Array <span style=color:#75715e>// true
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>arr</span>.<span style=color:#a6e22e>constructor</span>();  <span style=color:#75715e>//[]
</span></span></span></code></pre></div><h2 id=自执行匿名函数立即调用函数表达式>自执行匿名函数/立即调用函数表达式</h2><p>函数在创建之后直接自动执行，通常称之为自执行匿名函数（Self-Invoked Anonymous Function）或立即调用函数表达式（Immediately Invoked Function Expression ）。格式如下：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span>( <span style=color:#66d9ef>function</span>() {}() );
</span></span><span style=display:flex><span>( <span style=color:#66d9ef>function</span>() {} )();
</span></span><span style=display:flex><span>[ <span style=color:#66d9ef>function</span>() {}() ];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>~</span> <span style=color:#66d9ef>function</span>() {}();
</span></span><span style=display:flex><span><span style=color:#f92672>!</span> <span style=color:#66d9ef>function</span>() {}();
</span></span><span style=display:flex><span><span style=color:#f92672>+</span> <span style=color:#66d9ef>function</span>() {}();
</span></span><span style=display:flex><span><span style=color:#f92672>-</span> <span style=color:#66d9ef>function</span>() {}();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>delete</span> <span style=color:#66d9ef>function</span>() {}();
</span></span><span style=display:flex><span><span style=color:#66d9ef>typeof</span> <span style=color:#66d9ef>function</span>() {}();
</span></span><span style=display:flex><span><span style=color:#66d9ef>void</span> <span style=color:#66d9ef>function</span>() {}();
</span></span><span style=display:flex><span><span style=color:#66d9ef>new</span> <span style=color:#66d9ef>function</span>() {}();
</span></span><span style=display:flex><span><span style=color:#66d9ef>new</span> <span style=color:#66d9ef>function</span>() {};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>f</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>function</span>() {}();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>1</span>, <span style=color:#66d9ef>function</span>() {}();
</span></span><span style=display:flex><span><span style=color:#ae81ff>1</span> <span style=color:#f92672>^</span> <span style=color:#66d9ef>function</span>() {}();
</span></span><span style=display:flex><span><span style=color:#ae81ff>1</span> <span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>function</span>() {}();
</span></span><span style=display:flex><span><span style=color:#75715e>// ...
</span></span></span></code></pre></div><h2 id=从数组中随机获取成员>从数组中随机获取成员</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>items</span> <span style=color:#f92672>=</span> [<span style=color:#ae81ff>12</span>, <span style=color:#ae81ff>548</span> , <span style=color:#e6db74>&#39;a&#39;</span> , <span style=color:#ae81ff>2</span> , <span style=color:#ae81ff>5478</span> , <span style=color:#e6db74>&#39;foo&#39;</span> , <span style=color:#ae81ff>8852</span>, , <span style=color:#e6db74>&#39;Doe&#39;</span> , <span style=color:#ae81ff>2145</span> , <span style=color:#ae81ff>119</span>];
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span>  <span style=color:#a6e22e>randomItem</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>items</span>[Math.<span style=color:#a6e22e>floor</span>(Math.<span style=color:#a6e22e>random</span>() <span style=color:#f92672>*</span> <span style=color:#a6e22e>items</span>.<span style=color:#a6e22e>length</span>)];
</span></span></code></pre></div><h2 id=获取指定范围内的随机数>获取指定范围内的随机数</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>x</span> <span style=color:#f92672>=</span> Math.<span style=color:#a6e22e>floor</span>(Math.<span style=color:#a6e22e>random</span>() <span style=color:#f92672>*</span> (<span style=color:#a6e22e>max</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>min</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>)) <span style=color:#f92672>+</span> <span style=color:#a6e22e>min</span>;
</span></span></code></pre></div><h2 id=生成从0到指定值的数字数组>生成从0到指定值的数字数组</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>numbersArray</span> <span style=color:#f92672>=</span> [] , <span style=color:#a6e22e>max</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>100</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span>( <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>i</span><span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>; <span style=color:#a6e22e>numbersArray</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>max</span>;);  <span style=color:#75715e>// numbersArray = [1,2,3 ... 100]
</span></span></span></code></pre></div><h2 id=生成随机的字母数字字符串>生成随机的字母数字字符串</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>generateRandomAlphaNum</span>(<span style=color:#a6e22e>len</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>rdmString</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&#34;</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span>( ; <span style=color:#a6e22e>rdmString</span>.<span style=color:#a6e22e>length</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>len</span>; <span style=color:#a6e22e>rdmString</span>  <span style=color:#f92672>+=</span> Math.<span style=color:#a6e22e>random</span>().<span style=color:#a6e22e>toString</span>(<span style=color:#ae81ff>36</span>).<span style=color:#a6e22e>substr</span>(<span style=color:#ae81ff>2</span>));
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span>  <span style=color:#a6e22e>rdmString</span>.<span style=color:#a6e22e>substr</span>(<span style=color:#ae81ff>0</span>, <span style=color:#a6e22e>len</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#75715e>//generateRandomAlphaNum(50)=&gt;&#34;xzts8w4sf7id8yvf936m9529inj3nl1mf8bz7dbad6sp833di3&#34;
</span></span></span></code></pre></div><h2 id=打乱数字数组的顺序>打乱数字数组的顺序</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>numbers</span> <span style=color:#f92672>=</span> [<span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>458</span> , <span style=color:#ae81ff>120</span> , <span style=color:#f92672>-</span><span style=color:#ae81ff>215</span> , <span style=color:#ae81ff>228</span> , <span style=color:#ae81ff>400</span> , <span style=color:#ae81ff>122205</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>85411</span>];
</span></span><span style=display:flex><span><span style=color:#a6e22e>numbers</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>numbers</span>.<span style=color:#a6e22e>sort</span>(<span style=color:#66d9ef>function</span>(){ <span style=color:#66d9ef>return</span> Math.<span style=color:#a6e22e>random</span>() <span style=color:#f92672>-</span> <span style=color:#ae81ff>0.5</span>});
</span></span><span style=display:flex><span><span style=color:#75715e>/* numbers 数组将类似于 [120, 5, 228, -215, 400, 458, -85411, 122205]  */</span>
</span></span></code></pre></div><h2 id=数组之间追加>数组之间追加</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>array1</span> <span style=color:#f92672>=</span> [<span style=color:#ae81ff>12</span> , <span style=color:#e6db74>&#34;foo&#34;</span> , {<span style=color:#a6e22e>name</span> <span style=color:#e6db74>&#34;Joe&#34;</span>} , <span style=color:#f92672>-</span><span style=color:#ae81ff>2458</span>];
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>array2</span> <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#34;Doe&#34;</span> , <span style=color:#ae81ff>555</span> , <span style=color:#ae81ff>100</span>];
</span></span><span style=display:flex><span>Array.<span style=color:#a6e22e>prototype</span>.<span style=color:#a6e22e>push</span>.<span style=color:#a6e22e>apply</span>(<span style=color:#a6e22e>array1</span>, <span style=color:#a6e22e>array2</span>);
</span></span><span style=display:flex><span><span style=color:#75715e>/* array1 值为  [12 , &#34;foo&#34; , {name &#34;Joe&#34;} , -2458 , &#34;Doe&#34; , 555 , 100] */</span>
</span></span></code></pre></div><h2 id=对象转换为数组>对象转换为数组</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>argArray</span> <span style=color:#f92672>=</span> Array.<span style=color:#a6e22e>prototype</span>.<span style=color:#a6e22e>slice</span>.<span style=color:#a6e22e>call</span>(<span style=color:#a6e22e>arguments</span>);
</span></span></code></pre></div><h2 id=验证是否是数组>验证是否是数组</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>isArray</span>(<span style=color:#a6e22e>obj</span>){
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> Object.<span style=color:#a6e22e>prototype</span>.<span style=color:#a6e22e>toString</span>.<span style=color:#a6e22e>call</span>(<span style=color:#a6e22e>obj</span>) <span style=color:#f92672>===</span> <span style=color:#e6db74>&#39;[object Array]&#39;</span> ;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>但如果toString()方法被重写过得话，就行不通了。也可以使用下面的方法：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span>Array.<span style=color:#a6e22e>isArray</span>(<span style=color:#a6e22e>obj</span>); <span style=color:#75715e>// its a new Array method
</span></span></span></code></pre></div><h2 id=获取数组中的最大值和最小值>获取数组中的最大值和最小值</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>var</span>  <span style=color:#a6e22e>numbers</span> <span style=color:#f92672>=</span> [<span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>458</span> , <span style=color:#ae81ff>120</span> , <span style=color:#f92672>-</span><span style=color:#ae81ff>215</span> , <span style=color:#ae81ff>228</span> , <span style=color:#ae81ff>400</span> , <span style=color:#ae81ff>122205</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>85411</span>]; 
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>maxInNumbers</span> <span style=color:#f92672>=</span> Math.<span style=color:#a6e22e>max</span>.<span style=color:#a6e22e>apply</span>(Math, <span style=color:#a6e22e>numbers</span>); 
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>minInNumbers</span> <span style=color:#f92672>=</span> Math.<span style=color:#a6e22e>min</span>.<span style=color:#a6e22e>apply</span>(Math, <span style=color:#a6e22e>numbers</span>);
</span></span></code></pre></div><h2 id=保留指定小数位数>保留指定小数位数</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>num</span> <span style=color:#f92672>=</span><span style=color:#ae81ff>2.443242342</span>;
</span></span><span style=display:flex><span><span style=color:#a6e22e>num</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>num</span>.<span style=color:#a6e22e>toFixed</span>(<span style=color:#ae81ff>4</span>);  <span style=color:#75715e>// num will be equal to 2.4432
</span></span></span></code></pre></div><p>注意，<code>toFixec()</code>返回的是字符串，不是数字。</p><h2 id=浮点计算的问题>浮点计算的问题</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#ae81ff>0.1</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>0.2</span> <span style=color:#f92672>===</span> <span style=color:#ae81ff>0.3</span> <span style=color:#75715e>// is false 
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#ae81ff>9007199254740992</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span> <span style=color:#75715e>// is equal to 9007199254740992
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#ae81ff>9007199254740992</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>2</span> <span style=color:#75715e>// is equal to 9007199254740994
</span></span></span></code></pre></div><p>为什么呢？因为0.1+0.2等于0.30000000000000004。JavaScript的数字都遵循IEEE 754标准构建，在内部都是64位浮点小数表示，具体可以参见<a href=http://www.2ality.com/2012/04/number-encoding.html>JavaScript中的数字是如何编码的</a>.
可以通过使用<code>toFixed()</code>和<code>toPrecision()</code>来解决这个问题。</p><h2 id=通过for-in循环检查对象的属性>通过for-in循环检查对象的属性</h2><p>下面这样的用法，可以防止迭代的时候进入到对象的原型属性中。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>name</span> <span style=color:#66d9ef>in</span> <span style=color:#a6e22e>object</span>) {  
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>object</span>.<span style=color:#a6e22e>hasOwnProperty</span>(<span style=color:#a6e22e>name</span>)) { 
</span></span><span style=display:flex><span>        <span style=color:#75715e>// do something with name
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    }  
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=逗号操作符>逗号操作符</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>a</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; 
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>b</span> <span style=color:#f92672>=</span> ( <span style=color:#a6e22e>a</span><span style=color:#f92672>++</span>, <span style=color:#ae81ff>99</span> ); 
</span></span><span style=display:flex><span><span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>a</span>);  <span style=color:#75715e>// a will be equal to 1 
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>b</span>);  <span style=color:#75715e>// b is equal to 99
</span></span></span></code></pre></div><h2 id=提前检查传入isfinite的参数>提前检查传入isFinite()的参数</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span>isFinite(<span style=color:#ae81ff>0</span><span style=color:#f92672>/</span><span style=color:#ae81ff>0</span>) ; <span style=color:#75715e>// false
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>isFinite(<span style=color:#e6db74>&#34;foo&#34;</span>); <span style=color:#75715e>// false
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>isFinite(<span style=color:#e6db74>&#34;10&#34;</span>); <span style=color:#75715e>// true
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>isFinite(<span style=color:#ae81ff>10</span>);   <span style=color:#75715e>// true
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>isFinite(<span style=color:#66d9ef>undefined</span>);  <span style=color:#75715e>// false
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>isFinite();   <span style=color:#75715e>// false
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>isFinite(<span style=color:#66d9ef>null</span>);  <span style=color:#75715e>// true，这点当特别注意
</span></span></span></code></pre></div><h2 id=html字段转换函数>HTML字段转换函数</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>escapeHTML</span>(<span style=color:#a6e22e>text</span>) {  
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>replacements</span><span style=color:#f92672>=</span> {<span style=color:#e6db74>&#34;&lt;&#34;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;&amp;lt;&#34;</span>, <span style=color:#e6db74>&#34;&gt;&#34;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;&amp;gt;&#34;</span>,<span style=color:#e6db74>&#34;&amp;&#34;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;&amp;amp;&#34;</span>, <span style=color:#e6db74>&#34;\&#34;&#34;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;&amp;quot;&#34;</span>};                      
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>text</span>.<span style=color:#a6e22e>replace</span>(<span style=color:#e6db74>/[&lt;&gt;&amp;&#34;]/g</span>, <span style=color:#66d9ef>function</span>(<span style=color:#a6e22e>character</span>) {  
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>replacements</span>[<span style=color:#a6e22e>character</span>];  
</span></span><span style=display:flex><span>    }); 
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=处理websocket的超时>处理WebSocket的超时</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>timerID</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; 
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>keepAlive</span>() { 
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>timeout</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>15000</span>;  
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>webSocket</span>.<span style=color:#a6e22e>readyState</span> <span style=color:#f92672>==</span> <span style=color:#a6e22e>webSocket</span>.<span style=color:#a6e22e>OPEN</span>) {  
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>webSocket</span>.<span style=color:#a6e22e>send</span>(<span style=color:#e6db74>&#39;&#39;</span>);  
</span></span><span style=display:flex><span>    }  
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>timerId</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>setTimeout</span>(<span style=color:#a6e22e>keepAlive</span>, <span style=color:#a6e22e>timeout</span>);  
</span></span><span style=display:flex><span>}  
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>cancelKeepAlive</span>() {  
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>timerId</span>) {  
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>cancelTimeout</span>(<span style=color:#a6e22e>timerId</span>);  
</span></span><span style=display:flex><span>    }  
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><code>keepAlive()</code>函数可以放在WebSocket连接的<code>onOpen()</code>方法的最后面，<code>cancelKeepAlive()</code>放在<code>onClose()</code>方法的最末尾。</p><h2 id=一行代码调试css层>一行代码调试css层</h2><p>来看看下面的这段代码，它来自于谷歌“名猿”Addy Osmani在几天前贴出的一段代码，它的作用是用来调试你的CSS层。全部代码只有三行，但是你绝对可以把它放在一行里面完成：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span>[].<span style=color:#a6e22e>forEach</span>.<span style=color:#a6e22e>call</span>(<span style=color:#a6e22e>$$</span>(<span style=color:#e6db74>&#34;*&#34;</span>),<span style=color:#66d9ef>function</span>(<span style=color:#a6e22e>a</span>){
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>a</span>.<span style=color:#a6e22e>style</span>.<span style=color:#a6e22e>outline</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;1px solid #&#34;</span><span style=color:#f92672>+</span>(<span style=color:#f92672>~~</span>(Math.<span style=color:#a6e22e>random</span>()<span style=color:#f92672>*</span>(<span style=color:#ae81ff>1</span><span style=color:#f92672>&lt;&lt;</span><span style=color:#ae81ff>24</span>))).<span style=color:#a6e22e>toString</span>(<span style=color:#ae81ff>16</span>)
</span></span><span style=display:flex><span>})
</span></span></code></pre></div><p>在你的Chrome浏览器的控制台中输入这段代码，你会发现不同HTML层都被使用不同的颜色添加了一个高亮的边框。是不是非常酷？但是，简单来说，这段代码只是首先获取了所有的页面元素，然后使用一个不同的颜色为它们添加了一个1ps的边框。想法很简单，但是真要实现起来却不是那么容易的一件事。</p><h3 id=选择页面中所有的元素>选择页面中所有的元素</h3><p>第一件事情是获取页面中所有的元素，在上面的代码中，Addy使用了一个Chrome浏览器中特有的函数$$。你可以在你的Chrome浏览器控制台中输入$$(&lsquo;a&rsquo;)，然后你就能得到一个当前页面中所有锚元素的列表。
$$函数是许多现代浏览器命令行API中的一个部分，它等价于document.querySelectorAll,你可以将一个CSS选择器作为这个函数的参数，然后你就能够获得当前页面中所有匹配这个CSS选择器的元素列表。如果你在浏览器控制台以外的地方，你可以使用document.querySelectorAll(&rsquo;<em>&rsquo;)来代替$$(&rsquo;</em>&rsquo;)。更多关于$$函数的详细内容可以查看这个<a href=http://stackoverflow.com/questions/8981211/what-is-the-source-of-the-double-dollar-sign-selector-query-function-in-chrome-f#answer-10308917>stackoverflow</a>。</p><p>当然，除了使用$$函数之外，我们还有一种更简单的方法，document.all，虽然这并不是一种很规范的使用方法，但是它几乎在每一个浏览器中都能运行成功，更多请查看<a href=https://mathiasbynens.be/>Mathias Bynens</a>。</p><h3 id=迭代所有的元素>迭代所有的元素</h3><p>经过第一步，我们已经获得了页面内所有的元素，现在我们想做的事情是遍历每一个元素，然后为它们添加一个彩色边边框。但是上面的代码究竟是怎么一回事呢？</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span>[].<span style=color:#a6e22e>forEach</span>.<span style=color:#a6e22e>call</span>( <span style=color:#a6e22e>$$</span>(<span style=color:#e6db74>&#39;*&#39;</span>), <span style=color:#66d9ef>function</span>( <span style=color:#a6e22e>element</span> ) { <span style=color:#75715e>/* 在这里修改颜色 */</span> });
</span></span></code></pre></div><p>首先，我们通过选择器获得的列表是一个NodeLists对象，它和javascript中的数组有点像，你可以使用方括号来获取其中的节点，你也可以检查它其中包含多少个元素，但是它并没有实现数组包含的所有方法，因此我们并不能使用$$(&rsquo;*&rsquo;).forEach()来进行迭代。在javascript中，有好几个类似于数组但是并不是数组的对象，除了前面的NodeLists，还有函数的参数集合arguments，在这里我们可以使用call或apply函数将函数的方法运用到这些对象上。例如下面的例子：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>say</span>(<span style=color:#a6e22e>name</span>) {
</span></span><span style=display:flex><span> <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>( <span style=color:#66d9ef>this</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39; &#39;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>name</span> );
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>say</span>.<span style=color:#a6e22e>call</span>( <span style=color:#e6db74>&#39;hola&#39;</span>, <span style=color:#e6db74>&#39;Mike&#39;</span> ); <span style=color:#75715e>// 打印 &#39;hola Mike&#39;
</span></span></span></code></pre></div><p>// 你也可以将这种方法有用在arguments对象上 function example( arg1, arg2, arg3 ) { return Array.prototype.slice.call(arguments, 1); // Returns [arg2, arg3] }</p><p>在Addy的代码中，使用了[].forEach.call而不是Array.prototype.forEach.call，二者等价，但是前者可以节省几个字节。</p><h3 id=为元素添加颜色>为元素添加颜色</h3><p>为了让元素都有一个漂亮的边框，我们在上面的代码中使用了CSS属性outline。outline属性位于CSS盒模型之外，因此它并不影响元素的属性或者元素在布局中的位置，这对于我们来说非常有用。这个属性和修改border属性非常类似，因此下面的代码应该不会很难理解：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#a6e22e>a</span>.<span style=color:#a6e22e>style</span>.<span style=color:#a6e22e>outline</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;1px solid #&#34;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>color</span>
</span></span></code></pre></div><p>真正有趣的地方在于定义颜色部分：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#f92672>~~</span>(Math.<span style=color:#a6e22e>random</span>()<span style=color:#f92672>*</span>(<span style=color:#ae81ff>1</span><span style=color:#f92672>&lt;&lt;</span><span style=color:#ae81ff>24</span>))).<span style=color:#a6e22e>toString</span>(<span style=color:#ae81ff>16</span>)
</span></span></code></pre></div><p>天呐，上面的代码是什么意思？在javascript中，位操作符并不是经常被使用，因此这里可能会让很多程序员感到很疑惑。</p><p>我们想达到的目的是活的一个十六进制格式的颜色例如白色对应的是FFFFFF，蓝色对应的是0000FF，或者随便一个颜色37f9ac。虽然我们人类喜欢十进制，但是我们的代码常常会需要十六进制的东西。</p><p>我们首先要学会如何使用toString函数将一个十进制的数组转换为一个十六进制整数。这个函数可以接受一个参数，如果参数缺省，默认为十进制，但是你完全可以使用别的数组：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span>(<span style=color:#ae81ff>30</span>).<span style=color:#a6e22e>toString</span>(); <span style=color:#75715e>// &#34;30&#34;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>(<span style=color:#ae81ff>30</span>).<span style=color:#a6e22e>toString</span>(<span style=color:#ae81ff>10</span>); <span style=color:#75715e>// &#34;30&#34;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>(<span style=color:#ae81ff>30</span>).<span style=color:#a6e22e>toString</span>(<span style=color:#ae81ff>16</span>); <span style=color:#75715e>// &#34;1e&#34; 十六进制
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>(<span style=color:#ae81ff>30</span>).<span style=color:#a6e22e>toString</span>(<span style=color:#ae81ff>2</span>); <span style=color:#75715e>// &#34;11110&#34; 二进制
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>(<span style=color:#ae81ff>30</span>).<span style=color:#a6e22e>toString</span>(<span style=color:#ae81ff>36</span>); <span style=color:#75715e>// &#34;u&#34; 36是允许的最大参数值
</span></span></span></code></pre></div><p>除此之外，你可以使用parseInt函数将十六进制数字转换为十进制。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span>parseInt(<span style=color:#e6db74>&#34;30&#34;</span>); <span style=color:#75715e>// &#34;30&#34;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>parseInt(<span style=color:#e6db74>&#34;30&#34;</span>, <span style=color:#ae81ff>10</span>); <span style=color:#75715e>// &#34;30&#34;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>parseInt(<span style=color:#e6db74>&#34;1e&#34;</span>, <span style=color:#ae81ff>16</span>); <span style=color:#75715e>// &#34;30&#34;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>parseInt(<span style=color:#e6db74>&#34;11110&#34;</span>, <span style=color:#ae81ff>2</span>); <span style=color:#75715e>// &#34;30&#34;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>parseInt(<span style=color:#e6db74>&#34;u&#34;</span>, <span style=color:#ae81ff>36</span>); <span style=color:#75715e>// &#34;30&#34;
</span></span></span></code></pre></div><p>因此，我们现在只需要一个位于0和ffffff之间的十六进制数，由于:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span>parseInt(<span style=color:#e6db74>&#34;ffffff&#34;</span>, <span style=color:#ae81ff>16</span>) <span style=color:#f92672>==</span> <span style=color:#ae81ff>16777215</span>
</span></span></code></pre></div><p>而这里的16777215实际上是2^24-1。</p><p>如果你对二进制数学熟悉的话，你可能会知道1&#171;24 == 16777216。</p><p>再进一步，你每在1后面添加一个0，你就相当于多做了一次2的乘方：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#ae81ff>1</span> <span style=color:#75715e>// 1 == 2^0
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#ae81ff>100</span> <span style=color:#75715e>// 4 == 2^2
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#ae81ff>10000</span> <span style=color:#75715e>// 16 == 2^4
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#ae81ff>1000000000000000000000000</span> <span style=color:#75715e>// 16777216 == 2^24
</span></span></span></code></pre></div><p>因此，在这里我们可以知道Math.random()*(1&#171;24)表示一个位于0和16777216之间的数。</p><p>但是这里并没有结束，因为Math.random返回的是一个浮点数，但是我们只想要整数部分。我们的代码中使用波浪号操作符来完成这件事。波浪操作符在javascript中被用来对一个变量进行取反。</p><p>但是我们在这里并不关心取反，我们指向获取整数部分。因此我们还可以知道两次取反可以去掉一个浮点数的小数部分，因此~~的作用相当于parseInt：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>a</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>12.34</span>, <span style=color:#75715e>// ~~a = 12
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>b</span> <span style=color:#f92672>=</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1231.8754</span>, <span style=color:#75715e>// ~~b = -1231
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>c</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>3213.000001</span> <span style=color:#75715e>// ~~c = 3213
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>~~</span><span style=color:#a6e22e>a</span> <span style=color:#f92672>==</span> parseInt(<span style=color:#a6e22e>a</span>, <span style=color:#ae81ff>10</span>); <span style=color:#75715e>// true
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#f92672>~~</span><span style=color:#a6e22e>b</span> <span style=color:#f92672>==</span> parseInt(<span style=color:#a6e22e>b</span>, <span style=color:#ae81ff>10</span>); <span style=color:#75715e>// true
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#f92672>~~</span><span style=color:#a6e22e>c</span> <span style=color:#f92672>==</span> parseInt(<span style=color:#a6e22e>c</span>, <span style=color:#ae81ff>10</span>); <span style=color:#75715e>// true
</span></span></span></code></pre></div><p>当然，我们还有一种更加简洁的方法，使用或操作符：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#f92672>~~</span><span style=color:#a6e22e>a</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span><span style=color:#f92672>|</span><span style=color:#a6e22e>a</span> <span style=color:#f92672>==</span> parseInt(<span style=color:#a6e22e>a</span>, <span style=color:#ae81ff>10</span>)
</span></span><span style=display:flex><span><span style=color:#f92672>~~</span><span style=color:#a6e22e>b</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span><span style=color:#f92672>|</span><span style=color:#a6e22e>b</span> <span style=color:#f92672>==</span> parseInt(<span style=color:#a6e22e>b</span>, <span style=color:#ae81ff>10</span>)
</span></span><span style=display:flex><span><span style=color:#f92672>~~</span><span style=color:#a6e22e>c</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span><span style=color:#f92672>|</span><span style=color:#a6e22e>c</span> <span style=color:#f92672>==</span> parseInt(<span style=color:#a6e22e>c</span>, <span style=color:#ae81ff>10</span>)
</span></span></code></pre></div><p>最终，我们获得了一个位于0和16777216之间的随机整数，也就是我们想要的随机颜色。此时我们只需要使用toString(16)将它转化为十六进制数即可。</p><h2 id=变量转换>变量转换</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>myVar</span>   <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;3.14159&#34;</span>,
</span></span><span style=display:flex><span><span style=color:#a6e22e>str</span>     <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&#34;</span><span style=color:#f92672>+</span> <span style=color:#a6e22e>myVar</span>,<span style=color:#75715e>//  to string
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>int</span>     <span style=color:#f92672>=</span> <span style=color:#f92672>~~</span><span style=color:#a6e22e>myVar</span>,  <span style=color:#75715e>//  to integer
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>float</span>   <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span><span style=color:#f92672>*</span><span style=color:#a6e22e>myVar</span>,  <span style=color:#75715e>//  to float
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>bool</span>    <span style=color:#f92672>=</span> <span style=color:#f92672>!!</span><span style=color:#a6e22e>myVar</span>,  <span style=color:#75715e>/*  to boolean - any string with length
</span></span></span><span style=display:flex><span><span style=color:#75715e>and any number except 0 are true */</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>array</span>   <span style=color:#f92672>=</span> [<span style=color:#a6e22e>myVar</span>];  <span style=color:#75715e>//  to array
</span></span></span></code></pre></div><p>但是转换日期(new Date(myVar))和正则表达式(new RegExp(myVar))必须使用构造函数，创建正则表达式的时候要使用/pattern/flags这样的简化形式。　</p><h2 id=取整同时转换成数值型>取整同时转换成数值型</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#75715e>//字符型变量参与运算时，JS会自动将其转换为数值型（如果无法转化，变为NaN）
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#e6db74>&#39;10.567890&#39;</span> <span style=color:#f92672>|</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span><span style=color:#75715e>//结果: 10
</span></span></span><span style=display:flex><span><span style=color:#75715e>//JS里面的所有数值型都是双精度浮点数,因此，JS在进行位运算时，会首先将这些数字运算数转换为整数，然后再执行运算
</span></span></span><span style=display:flex><span><span style=color:#75715e>//| 是二进制或， x|0 永远等于x；^为异或，同0异1，所以 x^0 还是永远等于x；至于~是按位取反，搞了两次以后值当然是一样的
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#e6db74>&#39;10.567890&#39;</span> <span style=color:#f92672>^</span> <span style=color:#ae81ff>0</span>        
</span></span><span style=display:flex><span><span style=color:#75715e>//结果: 10
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#f92672>-</span> <span style=color:#ae81ff>2.23456789</span> <span style=color:#f92672>|</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span><span style=color:#75715e>//结果: -2
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#f92672>~~-</span><span style=color:#ae81ff>2.23456789</span>
</span></span><span style=display:flex><span><span style=color:#75715e>//结果: -2
</span></span></span></code></pre></div><h2 id=日期转数值>日期转数值</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#75715e>//JS本身时间的内部表示形式就是Unix时间戳，以毫秒为单位记录着当前距离1970年1月1日0点的时间单位
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>d</span> <span style=color:#f92672>=</span> <span style=color:#f92672>+</span><span style=color:#66d9ef>new</span> Date(); <span style=color:#75715e>//1295698416792
</span></span></span></code></pre></div><h2 id=类数组对象转数组>类数组对象转数组</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>arr</span> <span style=color:#f92672>=</span>[].<span style=color:#a6e22e>slice</span>.<span style=color:#a6e22e>call</span>(<span style=color:#a6e22e>arguments</span>)
</span></span></code></pre></div><p>下面的实例用的更绝</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>test</span>() {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>res</span> <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#39;item1&#39;</span>, <span style=color:#e6db74>&#39;item2&#39;</span>]
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>res</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>res</span>.<span style=color:#a6e22e>concat</span>(Array.<span style=color:#a6e22e>prototype</span>.<span style=color:#a6e22e>slice</span>.<span style=color:#a6e22e>call</span>(<span style=color:#a6e22e>arguments</span>)) <span style=color:#75715e>//方法1
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    Array.<span style=color:#a6e22e>prototype</span>.<span style=color:#a6e22e>push</span>.<span style=color:#a6e22e>apply</span>(<span style=color:#a6e22e>res</span>, <span style=color:#a6e22e>arguments</span>)              <span style=color:#75715e>//方法2
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>}
</span></span></code></pre></div><h2 id=进制之间的转换>进制之间的转换</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span>(<span style=color:#66d9ef>int</span>).<span style=color:#a6e22e>toString</span>(<span style=color:#ae81ff>16</span>); <span style=color:#75715e>// converts int to hex, eg. 12 =&gt; &#34;C&#34;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>(<span style=color:#66d9ef>int</span>).<span style=color:#a6e22e>toString</span>(<span style=color:#ae81ff>8</span>);  <span style=color:#75715e>// converts int to octal, eg. 12 =&gt; &#34;14&#34;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>parseInt(<span style=color:#a6e22e>string</span>,<span style=color:#ae81ff>16</span>) <span style=color:#75715e>// converts hex to int, eg. &#34;FF&#34; =&gt; 255
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>parseInt(<span style=color:#a6e22e>string</span>,<span style=color:#ae81ff>8</span>) <span style=color:#75715e>// converts octal to int, eg. &#34;20&#34; =&gt; 16
</span></span></span></code></pre></div><h2 id=将一个数组插入另一个数组指定的位置>将一个数组插入另一个数组指定的位置</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>a</span> <span style=color:#f92672>=</span> [<span style=color:#ae81ff>1</span>,<span style=color:#ae81ff>2</span>,<span style=color:#ae81ff>3</span>,<span style=color:#ae81ff>7</span>,<span style=color:#ae81ff>8</span>,<span style=color:#ae81ff>9</span>];
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>b</span> <span style=color:#f92672>=</span> [<span style=color:#ae81ff>4</span>,<span style=color:#ae81ff>5</span>,<span style=color:#ae81ff>6</span>];
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>insertIndex</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>3</span>;
</span></span><span style=display:flex><span><span style=color:#a6e22e>a</span>.<span style=color:#a6e22e>splice</span>.<span style=color:#a6e22e>apply</span>(<span style=color:#a6e22e>a</span>, Array.<span style=color:#a6e22e>prototype</span>.<span style=color:#a6e22e>concat</span>(<span style=color:#a6e22e>insertIndex</span>, <span style=color:#ae81ff>0</span>, <span style=color:#a6e22e>b</span>));
</span></span></code></pre></div><h2 id=删除数组元素>删除数组元素</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>a</span> <span style=color:#f92672>=</span> [<span style=color:#ae81ff>1</span>,<span style=color:#ae81ff>2</span>,<span style=color:#ae81ff>3</span>,<span style=color:#ae81ff>4</span>,<span style=color:#ae81ff>5</span>];
</span></span><span style=display:flex><span><span style=color:#a6e22e>a</span>.<span style=color:#a6e22e>splice</span>(<span style=color:#ae81ff>3</span>,<span style=color:#ae81ff>1</span>);           <span style=color:#75715e>//a = [1,2,3,5]
</span></span></span></code></pre></div><p>大家也许会想为什么要用splice而不用delete,因为用delete将会在数组里留下一个空洞，而且后面的下标也并没有递减。</p><h2 id=判断是否为ie>判断是否为IE</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#34;ActiveXObject&#34;</span> <span style=color:#66d9ef>in</span> window
</span></span></code></pre></div><h2 id=不用第三方变量交换两个变量的值>不用第三方变量交换两个变量的值</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#a6e22e>a</span><span style=color:#f92672>=</span>[<span style=color:#a6e22e>b</span>, <span style=color:#a6e22e>b</span><span style=color:#f92672>=</span><span style=color:#a6e22e>a</span>][<span style=color:#ae81ff>0</span>];
</span></span><span style=display:flex><span><span style=color:#75715e>//或者
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>a</span><span style=color:#f92672>^=</span><span style=color:#a6e22e>b</span>, <span style=color:#a6e22e>b</span><span style=color:#f92672>^=</span><span style=color:#a6e22e>a</span>, <span style=color:#a6e22e>a</span><span style=color:#f92672>^=</span><span style=color:#a6e22e>b</span>;
</span></span></code></pre></div><hr><blockquote><p>感谢：</p></blockquote><blockquote><ul><li><a href=https://chensd.com/2015-01/45-useful-javascript-tips-tricks-and-best-practices.html>不可能不确定-JavaScript奇技淫巧45招</a></li><li><a href=http://zhihu.com/question/20249179/answer/14487857>JavaScript 匿名函数有哪几种执行方式? - 回答作者: 长天之云</a></li><li><a href=http://arqex.com/939/learning-much-javascript-one-line-code>Learning much javascript from one line of code</a></li></ul></blockquote><h4><i class="fas fa-share-alt" aria-hidden=true></i>&nbsp;Share!</h4><ul class=share-buttons><li><a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fblog.dfned.com%2fpost%2fjavascript%25E5%25A5%2587%25E6%25B7%25AB%25E5%25B7%25A7%25E6%258A%2580%2f" target=_blank title="Share on Facebook"><i class="fab fa-facebook" aria-hidden=true></i><span class=sr-only>Share on Facebook</span></a></li>&nbsp;&nbsp;&nbsp;<li><a href="https://twitter.com/intent/tweet?source=https%3a%2f%2fblog.dfned.com%2fpost%2fjavascript%25E5%25A5%2587%25E6%25B7%25AB%25E5%25B7%25A7%25E6%258A%2580%2f" target=_blank title=Tweet><i class="fab fa-twitter" aria-hidden=true></i><span class=sr-only>Tweet</span></a></li>&nbsp;&nbsp;&nbsp;<li><a href="https://plus.google.com/share?url=https%3a%2f%2fblog.dfned.com%2fpost%2fjavascript%25E5%25A5%2587%25E6%25B7%25AB%25E5%25B7%25A7%25E6%258A%2580%2f" target=_blank title="Share on Google+"><i class="fab fa-google-plus" aria-hidden=true></i><span class=sr-only>Share on Google+</span></a></li>&nbsp;&nbsp;&nbsp;<li><a href="http://www.tumblr.com/share?v=3&u=https%3a%2f%2fblog.dfned.com%2fpost%2fjavascript%25E5%25A5%2587%25E6%25B7%25AB%25E5%25B7%25A7%25E6%258A%2580%2f" target=_blank title="Post to Tumblr"><i class="fab fa-tumblr" aria-hidden=true></i><span class=sr-only>Post to Tumblr</span></a></li>&nbsp;&nbsp;&nbsp;<li><a href="http://pinterest.com/pin/create/button/?url=https%3a%2f%2fblog.dfned.com%2fpost%2fjavascript%25E5%25A5%2587%25E6%25B7%25AB%25E5%25B7%25A7%25E6%258A%2580%2f" target=_blank title="Pin it"><i class="fab fa-pinterest-p" aria-hidden=true></i><span class=sr-only>Pin it</span></a></li>&nbsp;&nbsp;&nbsp;<li><a href="http://www.reddit.com/submit?url=https%3a%2f%2fblog.dfned.com%2fpost%2fjavascript%25E5%25A5%2587%25E6%25B7%25AB%25E5%25B7%25A7%25E6%258A%2580%2f" target=_blank title="Submit to Reddit"><i class="fab fa-reddit-alien" aria-hidden=true></i><span class=sr-only>Submit to Reddit</span></a></li></ul><style>ul.share-buttons{list-style:none;padding:0}ul.share-buttons li{display:inline}ul.share-buttons .sr-only{position:absolute;clip:rect(1px 1px 1px 1px);clip:rect(1px,1px,1px,1px);padding:0;border:0;height:1px;width:1px;overflow:hidden}</style><div class="prev-next-post pure-g"><div class=pure-u-1-24 style=text-align:left><a href=https://blog.dfned.com/post/mac-%E7%B3%BB%E7%BB%9F%E5%BD%BB%E5%BA%95%E5%88%A0%E9%99%A4node-js/><i class="fa fa-chevron-left"></i></a></div><div class=pure-u-10-24><nav class=prev><a href=https://blog.dfned.com/post/mac-%E7%B3%BB%E7%BB%9F%E5%BD%BB%E5%BA%95%E5%88%A0%E9%99%A4node-js/>mac 系统彻底删除Node js</a></nav></div><div class=pure-u-2-24>&nbsp;</div><div class=pure-u-10-24><nav class=next><a href=https://blog.dfned.com/post/%E5%9C%A8win10%E4%B8%AD%E8%BF%90%E8%A1%8Czsh%E6%88%96%E8%80%85%E5%85%B6%E4%BB%96shell/>在win10中运行zsh或者其他shell</a></nav></div><div class=pure-u-1-24 style=text-align:right><a href=https://blog.dfned.com/post/%E5%9C%A8win10%E4%B8%AD%E8%BF%90%E8%A1%8Czsh%E6%88%96%E8%80%85%E5%85%B6%E4%BB%96shell/><i class="fa fa-chevron-right"></i></a></div></div><div id=disqus_thread></div><script type=text/javascript>(function(){if(window.location.hostname=="localhost")return;var t,e=document.createElement("script");e.type="text/javascript",e.async=!0,t="defned-blog",e.src="//"+t+".disqus.com/embed.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(e)})()</script><noscript>Please enable JavaScript to view the <a href=http://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=http://disqus.com/ class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div></div></div><script src=https://blog.dfned.com/js/ui.js></script>
<script src=https://blog.dfned.com/js/menus.js></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-96875439-1"></script>
<script>if(window.location.hostname!="localhost"){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","UA-96875439-1")}</script><script src=https://blog.dfned.com/js/math-code.js></script>
<script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script></body></html>